{"ast":null,"code":"import { getSession } from \"next-auth/client\";\nimport { connectToDatabase } from \"../../../lib/db\";\n\nasync function handler(req, res) {\n  if (req.method === \"POST\") {\n    return;\n  } else {\n    const session = await getSession({\n      req: req\n    });\n\n    if (!session) {\n      res.status(401).json({\n        message: \"Not authenticated!\"\n      });\n      return;\n    }\n\n    const userEmail = session.user.email;\n\n    try {\n      //const data = await getPostsByEmail(userEmail);\n      const client = await connectToDatabase();\n      const usersCollection = client.db().collection(\"PostedItem\");\n      const data = await usersCollection.find({\n        posterEmail: userEmail\n      }).toArray();\n      res.status(200).json(data);\n    } catch (error) {\n      console.error(\"Error:\", error);\n      res.status(500).json({\n        message: \"Internal Server Error: Unable to fetch and Display Specific Posts\"\n      });\n      return;\n    }\n  }\n}\n\nexport default handler; // import { getPostsByEmail } from \"../../../lib/db\";\n// import { getSession } from \"next-auth/client\";\n// async function handler(req, res) {\n//   if (req.method === \"POST\") {\n//     return;\n//   } else {\n//     const session = await getSession({ req: req });\n//     if (!session) {\n//       res.status(401).json({ message: \"Not authenticated!\" });\n//       return;\n//     }\n//     try {\n//       const userEmail = session.user.email;\n//       const data = await getPostsByEmail(userEmail);\n//       //console.log(data);\n//       res.status(200).json(data);\n//       client.close();\n//     } catch (error) {\n//       // console.error(\"Error:\", error);\n//       res.status(500).json({\n//         message:\n//           \"Internal Server Error: Unable to fetch and Display Specific Posts\",\n//       });\n//       client.close();\n//     }\n//   }\n// }\n// export default handler;","map":{"version":3,"sources":["G:/FYP/LostNestfyp/lostnestprj/pages/api/myposts/fetchmypost.js"],"names":["getSession","connectToDatabase","handler","req","res","method","session","status","json","message","userEmail","user","email","client","usersCollection","db","collection","data","find","posterEmail","toArray","error","console"],"mappings":"AAAA,SAASA,UAAT,QAA2B,kBAA3B;AACA,SAASC,iBAAT,QAAkC,iBAAlC;;AAEA,eAAeC,OAAf,CAAuBC,GAAvB,EAA4BC,GAA5B,EAAiC;AAC/B,MAAID,GAAG,CAACE,MAAJ,KAAe,MAAnB,EAA2B;AACzB;AACD,GAFD,MAEO;AACL,UAAMC,OAAO,GAAG,MAAMN,UAAU,CAAC;AAAEG,MAAAA,GAAG,EAAEA;AAAP,KAAD,CAAhC;;AACA,QAAI,CAACG,OAAL,EAAc;AACZF,MAAAA,GAAG,CAACG,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAAEC,QAAAA,OAAO,EAAE;AAAX,OAArB;AACA;AACD;;AACD,UAAMC,SAAS,GAAGJ,OAAO,CAACK,IAAR,CAAaC,KAA/B;;AACA,QAAI;AACF;AACA,YAAMC,MAAM,GAAG,MAAMZ,iBAAiB,EAAtC;AAEA,YAAMa,eAAe,GAAGD,MAAM,CAACE,EAAP,GAAYC,UAAZ,CAAuB,YAAvB,CAAxB;AAEA,YAAMC,IAAI,GAAG,MAAMH,eAAe,CAC/BI,IADgB,CACX;AACJC,QAAAA,WAAW,EAAET;AADT,OADW,EAIhBU,OAJgB,EAAnB;AAMAhB,MAAAA,GAAG,CAACG,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqBS,IAArB;AACD,KAbD,CAaE,OAAOI,KAAP,EAAc;AACdC,MAAAA,OAAO,CAACD,KAAR,CAAc,QAAd,EAAwBA,KAAxB;AACAjB,MAAAA,GAAG,CAACG,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AACnBC,QAAAA,OAAO,EACL;AAFiB,OAArB;AAIA;AACD;AACF;AACF;;AAED,eAAeP,OAAf,C,CAEA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AAEA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA","sourcesContent":["import { getSession } from \"next-auth/client\";\r\nimport { connectToDatabase } from \"../../../lib/db\";\r\n\r\nasync function handler(req, res) {\r\n  if (req.method === \"POST\") {\r\n    return;\r\n  } else {\r\n    const session = await getSession({ req: req });\r\n    if (!session) {\r\n      res.status(401).json({ message: \"Not authenticated!\" });\r\n      return;\r\n    }\r\n    const userEmail = session.user.email;\r\n    try {\r\n      //const data = await getPostsByEmail(userEmail);\r\n      const client = await connectToDatabase();\r\n\r\n      const usersCollection = client.db().collection(\"PostedItem\");\r\n\r\n      const data = await usersCollection\r\n        .find({\r\n          posterEmail: userEmail,\r\n        })\r\n        .toArray();\r\n\r\n      res.status(200).json(data);\r\n    } catch (error) {\r\n      console.error(\"Error:\", error);\r\n      res.status(500).json({\r\n        message:\r\n          \"Internal Server Error: Unable to fetch and Display Specific Posts\",\r\n      });\r\n      return;\r\n    }\r\n  }\r\n}\r\n\r\nexport default handler;\r\n\r\n// import { getPostsByEmail } from \"../../../lib/db\";\r\n// import { getSession } from \"next-auth/client\";\r\n\r\n// async function handler(req, res) {\r\n//   if (req.method === \"POST\") {\r\n//     return;\r\n//   } else {\r\n//     const session = await getSession({ req: req });\r\n//     if (!session) {\r\n//       res.status(401).json({ message: \"Not authenticated!\" });\r\n//       return;\r\n//     }\r\n\r\n//     try {\r\n//       const userEmail = session.user.email;\r\n\r\n//       const data = await getPostsByEmail(userEmail);\r\n//       //console.log(data);\r\n\r\n//       res.status(200).json(data);\r\n//       client.close();\r\n//     } catch (error) {\r\n//       // console.error(\"Error:\", error);\r\n//       res.status(500).json({\r\n//         message:\r\n//           \"Internal Server Error: Unable to fetch and Display Specific Posts\",\r\n//       });\r\n//       client.close();\r\n//     }\r\n//   }\r\n// }\r\n\r\n// export default handler;\r\n"]},"metadata":{},"sourceType":"module"}